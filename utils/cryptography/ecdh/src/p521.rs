#[cfg(test)]
mod tests {
    use curves::P521;

    use crate::{test_ecdh_vector, tests::TestVector, Ecdh};

    const TEST_VECTORS: [TestVector; 30] = [
    TestVector {
        private_key1: "00000183f1248511cd928354908e3919d8e2d77fdc67d1b7b0c9eb44fd68ca0f3bc7c734bbf60e60fc3f49bb90b84def6e131bcd30ef4d304e44954c15d7562aa39d8288",
        private_key2: "0000008d11253b5a67480ae707a3fb6fab8feab95340af9373de27dad6870febbe63a293950675bfdb202760525ea6a9726ef20c60ccf32a786872cba770f126ef26d05d",
        shared_secret: "003dea13cbb7afb738d9fbeb94166e9f97e3f060ac7703977c68d3b876f2967d4efd7ccb3093d322e0d17e6e94e0f60259afad9ffb46526e23621a400ae48ef87547",
    },
    TestVector {
        private_key1: "000000d25f47ad9b702e9cb46a1f2646b3824b02525c3ce5250bf0658eff66ea4462b24561233cad81cf24243a296a014f92ff095b4428df21c11c85a0a292fa4f3173d0",
        private_key2: "000000a370cb000fbe719600180830fc0edddb400cb12f478cfd0cbbedacef9f0bd62951b8385aa0d6b190e49a7c5840c95258aa6e62827e6e2afdc6e93888d2a1622d43",
        shared_secret: "0105621bca0e8e54bcf5a6ff7267dac0e80a51fa6e657e82d2e0db8b729815677d7568df7e07ce088846b08ae5341761be5be3d67c1c2549b0ca2b9634d57ebb33fa",
    },
    TestVector {
        private_key1: "000001e8a064446f3fb95b80fd2754957e102e8392fe98254fbf2c80c6cc430319346b74e95d65e80ac4f82620041d948019e88f508bbd29c2a77ec07145d9862f6e8c4f",
        private_key2: "00000104ee60b722f35ba0b823ecb7876d084938e04c19120fcb6f575bfc7140377e52726744eba92f527cc2060221ae7fbf9c28835d68f999b1ebf20085f80eb82841cb",
        shared_secret: "00e809fb15494c9d49cf3f410efc7b1c3579923bf271804d669c9b93f0041277b3b68e6738979db3518f3b79d87c57a233fe497f207a9dad3d259871e57123f6ef62",
    },
    TestVector {
        private_key1: "000000ac1b2611281387b091bb5bda1e239dfa1d27a29388d924ee85614ca9cb684962a54ba470d633e206f75b3b401d521a22c0dde2440095125f6bd7d5bbc20b755ab2",
        private_key2: "0000018e21b46cb918e9890b2b945da8ca7e7fafb162c39fb1fc416343b6d9a364697cd79307dcc840b17c3032a235fa0d2e7bda9824fb6d56cce85680567f06e35ca199",
        shared_secret: "01d5271c94cde5aed83d1e50fe291d4e19c43428f601a221bd72b9b2c767763427480399cbac6e49fb5d64546d82e202fe9a9e14bbb701a6f7da60856d504de7da23",
    },
    TestVector {
        private_key1: "000001254e66ab0e09dd16cae616da9f28d101ad78ed3d8ea0642cf2eb302e27dce0a4cd936b42ab8f2ff0170f5d90f6b4ffbdb17669c28b956d6d9ef1f2166302587b2c",
        private_key2: "000000baf10e14114f925b0ba680f78be0f315733517cf7f6720ed551069b4c09c84af14b64df57476870931060016eba0f219a02152f16cddcbf81d0295e59759d4c056",
        shared_secret: "01966d2cba60e495143c306dd72f6c32708fa5de026d66fa74548248ae440b0be101c96c951b48b54938663a5612627d0cc4172f384388cd11875201765dcca72efc",
    },
    TestVector {
        private_key1: "00000150fb288caf51d92d5cf302b6e6c081f0f3e37b725f7d1a73416d7533d66503c81595f34d886d28c587cab10ae1c45751c107d2934cce5bc7d4c384b2190b486d31",
        private_key2: "0000001ac5b7b33dd21c02921d79310c6d4343c23ed3704b29eea3545276225c5df46c2f075ecdeacddceaf893f96f0907f62f9cfd20a3967acf0773f5d8fae313059be7",
        shared_secret: "0059f5ba62083adefeac0eeb7042b88de9312f24fc3f181b6b69454b61ccc5b137700b5d340b61a7b39f0cc576caf833c568b0db4adf66f8f94db7e24ff2ebbffb19",
    },
    TestVector {
        private_key1: "000000d70713b1f8d3672ecc86a0ad22335d1510c8fdc6a594da2787ecab439fd74843c5caaca5d70a4a36727a0f0c025f60191d985545a2f7a8a4bea3fd2f2cca0bf427",
        private_key2: "000001eb0c40af1435f3687d07d82ba5c2a38c1ba61931481b8c14e4cad2869dc3ef49e009478835b302642f9bd55d1ad36c916d28f03c74efe82d3f70ba4b1dbed32b86",
        shared_secret: "018d4a489cd726a5fd069e6e10be26db2e69a094b723b741ebee5704df7950b4f05d0a6660f413ec6d84ca8ffd78fdb7c5b7c7dee917ffc255c670c720053525ec16",
    },
    TestVector {
        private_key1: "000000a6d31477acc273eaf78fbbc78bc2b2c9a636910e52036ccfc3bdca561339c574d7c8a9ffb063f596e4e2eeac44933aec636bbf2db0f6b5bbc61e182805bf240793",
        private_key2: "000000770b8a5d3c857eebb58db47a5cbf366ff1fec4e67f7604cf2f994b91346b931a227e11b7b3de49a4662213717aea4ba6481f21637562357687068c9977a2ec9198",
        shared_secret: "001b03a190a244da5296b96e06770bf140403a863f148baafe9b24302d7636a44a118590eaa4a0b376e7e67c65bac797aee51c6261cfa93cfdb2dc45ff2843f3692f",
    },
    TestVector {
        private_key1: "0000018c0f67fc695426a677ef5b9e5384d61b7e8ab6c50d27dd4700d19acff3e534953827ac2d18e8402f717bf913bc15c0ef488dc5315eb854b8565ba664ddc0b42817",
        private_key2: "00000053fd7f990f75e3da9be95f06de1204cf6090de817c114bd348691f278654b1f41c5c68e636745d7c7116064ad1e3ebb35511b206058c26e5bc018cb426e561a446",
        shared_secret: "01e117e201feb975ef6b0f9e7cca8eafafc0002ae8f4d09d2ee3815f8fc932791facd2f6c31e4a758d974a51390c2483c7864a19f9e1c9efaac77f56eb5b14acc790",
    },
    TestVector {
        private_key1: "0000009d64d68f3e2f1c0f226614459ab9b887a0a01eac3069de23e26292ff5a21b187a107ace2a54c5d26259ba921087cea04e8cd27f57d3f9fe7814ac377d892588971",
        private_key2: "000001ef9544466a4114767d1b9837ba885d406e9d3432f1d9c8862cab65841d0d881c00ba0d74512dbedfb276eeee35480a531d63906e23d7027ca0c1135a2c6ced58ba",
        shared_secret: "002ab579444e0fea080a945d992082b06167d0e6001b16a1d1af41bf3127cada27c68476f713d8ed29ab412469fe432e105dc9e39e66fba3f3ba7d73683824bd5a0f",
    },
    TestVector {
        private_key1: "0000008ca03c639ed42c9eeead7100f25252993818888aba2932ca026fa0c6fc32061110e37378e46836e9228192618d0a7e9921bf235a6c8d9df79d555fbe6334706383",
        private_key2: "0000002b91d814bbd81c4dab243d6b2fc4777cce4880b2e877874816f5b9f701d0ee09a89de32ab23956fe91802b841afe653c8b0031e5199c7ebd0d2cc4a0a51ec70bba",
        shared_secret: "015323d8b55dfc7e83dbc1bc3b8f57748061b9a70e0afe01e6746d61d18612f1b40871f11f0386eb6f509e454823cb85340aeecd7dd1a53ee70c4ca7d3f9a0166834",
    },
    TestVector {
        private_key1: "0000007e6114f88f67462c136e7615fc5a1aec8976d194770e50f6bf5a2d20869e5ba1e1f464fb302a6c77efcc9716ca1be63b64ef922728bb528a277d768b3021bf884a",
        private_key2: "0000001e92b1867246c3e3e4b4cfceac6fe18777b635521608bc3b9988270e3a75c6c46d1bd8b55042e08a473ff53ac78b3c74ef9cfb0df2ce54cf18653bcd5920f23d9b",
        shared_secret: "013402b42f73343da4452cd7aaa2ace7c8081c0fdd1732b1486d90c622a20c8ad89c2421a13744cb198d9fc957bd2f12dd9857aea66a772035d374523b2be16be197",
    },
    TestVector {
        private_key1: "00000072155136a001449a006dd05c1021f6f9e35e960f48627171be70519a498eaf1204c303fca4bc4893aab804246e98a61fac25c59e98bbb955895719b230db2a94d0",
        private_key2: "0000010591cdd5c2c62be4aa7d719bd0d20851fa139b857bf03233ed2b8544d8abcb0e95ac4139b2540b51d7fcd9e850c26061d20e90a25243a0ec4db2c19a07a8225a61",
        shared_secret: "00383f3bef30ac14d8da07d013cac3f5ab4871143a70c396645a4e1a71251c4ce4073683f01ed61160865e8e4532ef7268a0130f88fa6b6201e8d8cef119132e2451",
    },
    TestVector {
        private_key1: "000001b30b938416c554ae08fbf2c85e61e25315c101241e4814794d318055717d98954ce50304198cb3e2d201f6c970c4185e956de90d659511507d90c2c4f009bbf138",
        private_key2: "00000021e0c9d3a50a5e7ffa8866e62c871a9fd8835d6e3df78dda5d761cd467edbf3601e81daacb309aaee06ce8886d6e1f373f5d66bb4ae872dcd4d24f84e1a8abe893",
        shared_secret: "02e72ad4e823e67636dd091d076ca03bc435065d37ed9ebc53d18c7708005a27ef2891a58eb3012ea7c4afa2c74dbeadeb0442d974592713e7b9f9224b6171e03f90",
    },
    TestVector {
        private_key1: "000000e8a912e1e6c7a6671abde5387c4bb65dc332a3be1115e75533da349446ac202e4648fbd61c60cf8154562583daa9b7ed8c3875ad7fd66b36982451e398c0320c90",
        private_key2: "00000071ebf54cd1e2318ac0c3cf0f7c923faaf4b7c2a311dce0c206749a64d4c07360dac21f8a49a78d47a206d5fe1e2030014223260816327c7ca0aae7bfe14e4aa31d",
        shared_secret: "00022d47c16c5881e4e0553ee5f76333e43ecb8668fb30c52399c9101cb1a608e1b2194f28dec93bc4906660f8c5aadaeb492ffe21aba171b9e849f332641600f888",
    },
    TestVector {
        private_key1: "000001668e9cba0e625eba0123d478b17ae10856ab48ed24882187f6e56f2cea4cb2f91c168fd5473ff41a76813193a1cf1f77c384b414bbc360e3c8c75b2b0cf227d3cd",
        private_key2: "0000019146627ad2b9c74a4603ecc90a86bbe42cdc22e1162b307eb8635f709e1615306af897ceada0dc7dc05938b893f8d787bc45bbe4268464f6f724ca3f674b6c36b6",
        shared_secret: "00a30f9b82d210f88c4883b92abaaf485bb954b47d6a58cc6d7c3d7562082f796a003535e94bfe892ba74d9a9b05a54d38c97c7257acb1de8f818b8cb31789d8b514",
    },
    TestVector {
        private_key1: "000000353b394a42a418f9f0a4e5f037f8b7daa8bfe032c3779bcfed37525b65069b1d465eb5ab7d648af8ec278f45dd63233b9a56118e394832e271d25b4cf86c38feda",
        private_key2: "00000138257f04b99e622aaef3874b28617240b1dda111ba55f063424ade8ab79e38fcf912c541b6be5b012afa180dc8fc057a3c508fca20c486fabbb6df2cf576af3238",
        shared_secret: "0121f2367fe4e9daacb99f328f028f4cf54b044185c5d88ddd36cfe2e4d7192ed2d4d867baea6634548dadc17e8b1d1d9f738eaedf008c1a8e219de6612c7b320a19",
    },
    TestVector {
        private_key1: "000000a9c36a901e384d1abc7aef3b8f7b267ee7f1ceec819e0f16068fe2b3970ecb3327a044d9f4793351faa5636ad9f47cd4992da2139ec19c296581bec7576805b61c",
        private_key2: "0000015b7d4173bf21955fe0eb589c07b84cbfd380ea21f853e615e69c61e286f231cdc22d90bbbd86f6b8c98bc232cb4276df4a0b34e15ec458d64316f844ef3e0fda7a",
        shared_secret: "01e8e812d31270a76045f55b6ff1d31e534654a39316608239212810b27b97088a6487ee8c8b262f5c6fb0481b8e605a1499bcbda705a49f7de09a8aa2526f7f2ce8",
    },
    TestVector {
        private_key1: "000000eda26981ee388ad04d234a954c64fd8c820ce524de8c043b8640e85514453c9545ecb938578e28f83e4e8aa08687856f100976e1a6c94c312055be5366e3cdce41",
        private_key2: "000001b3daf7f6f27b81195e75cc4c6848dd146b00680235ccd4364966a43186833f80277c2fcef54c5657517e90df15a39fc1f38c3a557ebd0669cc0ec5e7c3c40028fb",
        shared_secret: "00d0fdc10ed001d8a4e52d39ae8cdadbc7de0e68017c4f3d64c20c80a94f572a8e0bb4b07e915a017b8d43b1233a6ba674f64aad89e20a797f230ca16f967eb0455d",
    },
    TestVector {
        private_key1: "0000000fd1112001f95f32f58f8abe4f029b0081c984a58586367924e51f40797178c5536160cbe6d3aea2fc6ca9e880398705f124fd252c72d1f8e50e6de64ccc2b98b6",
        private_key2: "00000143fec85ce2c57403a3a2d9d34b462ae5b4c472329187fd10202dce874b075cea840d718d01176fe0c8917c02bd8627bbf22fd1677b8c05cf870df1b4202fb416fc",
        shared_secret: "002f5f33018cb8ad759e53419aa19c7f80e40157ce7fdd3eaebcabd4c5061c14eae387a3771a5af00ea67303a0d9f8dbacfb868639b703ba2dad659db8f656a80d4f",
    },
    TestVector {
        private_key1: "0000002b6b08e24224cb3360ee2ada048826075865901f5f3f39de3aed3d7b0b708fb55dc01a07545c422d2ed626c189ea5b7ba89c260d5ab5e3b9e3711d8c38453235ea",
        private_key2: "000001c51b44fa461b1d388d7fb4b85cb23fcefa8d87b9a55c9a0ebc88f909f904c7c429c63a18acf22f9688fc011421555c1b76bb78262c74494a5d972a902d2c43a106",
        shared_secret: "013f9dd20985935c2189df52a5c56566b9e7528d6cea68fdc8936f110dbc1a43e8919f0ee0adb44e2603147d71294700aaee04a845e43354a44d9afe8eebdf67da79",
    },
    TestVector {
        private_key1: "000000d92041fb71541540cacad85da7c2354c59cccd148994a2eff060e1e838fd9903fd4bb13d46cde447c3c7bf5acde232dd065cc3a026f7988e10dce1048c265b56a9",
        private_key2: "000001e17930fbfc45098011eb780dae77ee8acb16246bff2aafb60cab4208bbdf9ade334bf9dc3b0f16b70c17f88d3b8636d5160126afc6885236e8d93e9b4ec36308af",
        shared_secret: "00b6d6d84595ed0a781f5785184647af651d6603d5e92992df918a3f01e06b1234f29f3dcf17ad7596f8873986e5b4e995d2811a2c24845065a7679e3f578ec84a36",
    },
    TestVector {
        private_key1: "0000016ed09f5d21b279075b73dbf31e3670dc6954eba8c459ce8a37d3e1a4da246d9d45165469fcf24316b87bc83902b07ba0ce91661c7c9c9e275e56fb882c476435a6",
        private_key2: "0000006d43fd8d415d3c4f0b8607cf9d73d935138cd1dfaff8114825a387ce155206d338b3ea23052ed1b0734d05fd31f336320ddfa45e1790b0d7e20f7020f3824ef3f6",
        shared_secret: "013aa689a0134c48614fa1165693c8510af37a7fff66e408a12db2f2b820815fd2ba97d4860eba62112cd1e7929a95d353ff12297168e1e3b278b1092b5f9c96ba69",
    },
    TestVector {
        private_key1: "00000037e492883339bf6a7e2f96182738d22a4e25a5ddef335a76a5e4622e36174d0ae0fcc82dbe35a71a637b57ecfec1654f3f9c88c1eac6730490d80bfe184f84deab",
        private_key2: "0000017ec152c8a0eb82656789643f5db9cc1eb373725957446cbcaf0ae91d71361530ec6c4362123079111b7ba6b2628bd3fe4dd08005f9240f1a1e0edf18868c17f1d8",
        shared_secret: "007fd3d88a4d42a99925cdf8552866b53a6ddd6b1c520eb3e6125d49b56c68419abbd51b816ea104c2bbed5c1cd84279a88333a0579c1660340786a2b5fae4862f59",
    },
    TestVector {
        private_key1: "000000c419bb6d84165a68410dbc868d55488c3efd70ef25935e83c547a0cc775dc33b0dbcdac40cb0042658d66ef97b467f9bfea7842dc0d6652ca098e998944b7a8642",
        private_key2: "000001b3c910d7d386f64219ddcc974899fc87054cca58d56ee8a25970a9785a6d52c8e69e3f9a1e34a5fd5487a58116f55d505f301eae12a60457feab0fb98231e4143d",
        shared_secret: "01576fe39bd259499b5261a29610a12c8b2c6bbd53bc67fcf4949bc7563a1b5f784c720e4ff4fb25c895b1aec02edec07207dbd1b756090eb95c44b3f77d1b25c772",
    },
    TestVector {
        private_key1: "0000010cd4bc5bd733302c685232251fa6b6f91d30ca8a9c50b109f8a95e2be95983abc3e487aad6604e20b6136ccc91c80bd580d0d8df3194aa2094e1bfc7b864d5d07b",
        private_key2: "000000f3e9f61368c562eb7f266a52fd897dd8d8775c6f7a966c85abe8e808c83d966802743ecb718cbeec5d17a0a047bfb29eecb0708bf228efc2a563548aa51dfdeaa2",
        shared_secret: "002dd34c865db33927233b1f2a91a83a7aa1b87a2d5dd2bda4345c476fcc6ae6ef9117047614a1d5c890caa319278485d0f4e9291cdca321c2d63777068ab9766d4e",
    },
    TestVector {
        private_key1: "000001dd858c55c7918f9a33378c1ea378cd9ec1f1b7f5f404aec53c126709b127d70ec1d3be1faabbcd00412186ac426638fd4b1f68023a27cbe89df8f8d78e152ea96f",
        private_key2: "000000973ad883db01c1ff82242a37c0b413db0ae0f528c96d804ea9c61540015dfd5d87c4977b5f26f4c891fd936d3951e63ec8dd146a74a98dc6e581a2e06c47d4f991",
        shared_secret: "0161f79a8d9b82bdbef4efb5f1908b5b69a10537219bb159da14f18adba839353a374ee3b3a2e526b2ecd569a64621714ef33ea65b8b55623c68ae3d53f15c9daefd",
    },
    TestVector {
        private_key1: "000001a4adb02c902afdbe531255c1f1797f00d34c59a4b925476f4c1d8579e2c65e83bb92cab54fe665dacc20102528bdd53083d4967438863ef281563b6dc17a20cc68",
        private_key2: "000001f0e24ed6f9810037546d24329a5e6f38e41ab8de5df6f517ed55f514888a7fbd1c7ffcd8f926499d266a5018dd66e18847b0b19befd5b075a7393cffe5c4ad6bdf",
        shared_secret: "0217bdafb6c478eaab43da04f1fb8c606b234c8f3f6dd30d1b97ab971083e362a4d83e4f832a1cf26e0aa32040fdee0cfe33c79c9eaf228cacad81fa44d348cf793d",
    },
    TestVector {
        private_key1: "000000940d0f3aafeae39efd707e9f48146c7d33a7da719f5f815e439fc6d06ff07e11479a99d36df6df7cbec81728e213b1d0b2b71afb9541bc23abd9d0d1b294cbdc68",
        private_key2: "000001ac2afadb0e8589809e2a88de5328158676f6cb746948997417fc61cad2fc5db0caeca42d3122eb6c7af93816673741f51c50730e7007fa0601943e1f3438ac0ab8",
        shared_secret: "0135dcbd1625f56731900509b680553a481e149bb39889d454b2b796b55ae2fa23186f975bd451699044bea80fd5b6177b589d2bcac02375ceb3ff026f301720898c",
    },
    TestVector {
        private_key1: "000001fa0053c70383d23209e9347e496059451a9ba1f7d243762b015ec10271cee0c3abf5d2b1a567209b82b05a097c069f892f617abcb6d32693f6650110e31982b436",
        private_key2: "000001cce4129849a75de4e8120dd8902d806e86fbe8ee8fe1f636221efc51c4fc40a95f29838498b1a92881382f1751ea3fd8b375a530b6b795623f693a2daf8fa6e334",
        shared_secret: "017feab0d53d7c1788e13266803933dc5bc5d4048ac17729a9ea9d7bd4d33e995d4415e9da22f46de821cf7f2d041f9731f1203d4986e04aea5246e385372da6678c",
    },
];

    #[test]
    fn p256() {
        let ecdh = Ecdh::new(P521);
        for test_vector in TEST_VECTORS {
            test_ecdh_vector!(test_vector, ecdh);
        }
    }
}
